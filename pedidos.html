<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Pedidos Recebidos</title>
<link rel="stylesheet" href="pedidos.css">
</head>

<body>

<h1>ğŸ“¦ Pedidos Recebidos</h1>

<div id="listaPedidos"></div>

<script>
function carregarPedidos() {
  const pedidos = JSON.parse(localStorage.getItem("pedidos")) || [];
  const container = document.getElementById("listaPedidos");

  container.innerHTML = "";

  if (pedidos.length === 0) {
    container.innerHTML = "<p class='vazio'>Nenhum pedido ainda.</p>";
    return;
  }

  pedidos.reverse().forEach((pedido, index) => {
    let itensHTML = "";

    pedido.itens.forEach(item => {
      itensHTML += `<li>${item.nome} - R$${item.preco}</li>`;
    });

    const taxa = pedido.taxaEntrega || 0;
    const totalComEntrega = Number(pedido.total) + Number(taxa);

    container.innerHTML += `
      <div class="pedido">
        <div class="pedido-topo">
          <span class="loja">ğŸª ${pedido.loja}</span>
          <span class="data">ğŸ—“ï¸ ${pedido.data}</span>
        </div>

        <ul class="itens">${itensHTML}</ul>

        <div class="taxa-entrega">
          ğŸšš Taxa entrega: R$
          <input type="number" min="0" value="${taxa}"
            onchange="atualizarTaxa(${pedidos.length - 1 - index}, this.value)">
        </div>

        <div class="pedido-total">
          ğŸ’° Total: R$${totalComEntrega}
        </div>

        <button class="excluir-btn" onclick="excluirPedido(${pedidos.length - 1 - index})">
          âŒ Excluir pedido
        </button>
      </div>
    `;
  });
}

function excluirPedido(index) {
  if (!confirm("Tem certeza que deseja excluir este pedido?")) return;

  let pedidos = JSON.parse(localStorage.getItem("pedidos")) || [];
  pedidos.splice(index, 1);
  localStorage.setItem("pedidos", JSON.stringify(pedidos));

  carregarPedidos();
}

function atualizarTaxa(index, valor) {
  let pedidos = JSON.parse(localStorage.getItem("pedidos")) || [];

  pedidos[index].taxaEntrega = Number(valor);

  localStorage.setItem("pedidos", JSON.stringify(pedidos));
  carregarPedidos();
}

carregarPedidos();
</script>

</body>
</html>